import{r as t,h as n,H as e}from"./p-ddbb1df8.js";import"./p-bec3b19e.js";import"./p-58d13c5e.js";import"./p-f3a0c163.js";import{l as r}from"./p-d5d1c985.js";import{s as i}from"./p-38942298.js";function a(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function o(t){let n=t,e=t;function r(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;e(t[a],n)<0?r=a+1:i=a}return r}return 1===t.length&&(n=(n,e)=>t(n)-e,e=function(t){return(n,e)=>a(t(n),e)}(t)),{left:r,center:function(t,e,i,a){null==i&&(i=0),null==a&&(a=t.length);const o=r(t,e,i,a-1);return o>i&&n(t[o-1],e)>-n(t[o],e)?o-1:o},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;e(t[a],n)>0?i=a:r=a+1}return r}}}const u=o(a).right;o((function(t){return null===t?NaN:+t}));var s=Math.sqrt(50),l=Math.sqrt(10),h=Math.sqrt(2);function c(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=s?10:a>=l?5:a>=h?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=s?10:a>=l?5:a>=h?2:1)}function f(t,n,e){var r=Math.abs(n-t)/Math.max(0,e),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=s?i*=10:a>=l?i*=5:a>=h&&(i*=2),n<t?-i:i}function d(t){return Math.ceil(Math.log(function(t){let n=0;for(let e of t)null!=e&&(e=+e)>=e&&++n;return n}(t))/Math.LN2)+1}function v(t,n){let e;if(void 0===n)for(const n of t)null!=n&&(e<n||void 0===e&&n>=n)&&(e=n);else{let r=-1;for(let i of t)null!=(i=n(i,++r,t))&&(e<i||void 0===e&&i>=i)&&(e=i)}return e}function g(t,n){let e;if(void 0===n)for(const n of t)null!=n&&(e>n||void 0===e&&n>=n)&&(e=n);else{let r=-1;for(let i of t)null!=(i=n(i,++r,t))&&(e>i||void 0===e&&i>=i)&&(e=i)}return e}function p(t,n,e){const r=t[n];t[n]=t[e],t[e]=r}function w(t,n,e){if(r=(t=Float64Array.from(function*(t,n){if(void 0===n)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let e=-1;for(let r of t)null!=(r=n(r,++e,t))&&(r=+r)>=r&&(yield r)}}(t,e))).length){if((n=+n)<=0||r<2)return g(t);if(n>=1)return v(t);var r,i=(r-1)*n,o=Math.floor(i),u=v(function t(n,e,r=0,i=n.length-1,o=a){for(;i>r;){if(i-r>600){const a=i-r+1,u=e-r+1,s=Math.log(a),l=.5*Math.exp(2*s/3),h=.5*Math.sqrt(s*l*(a-l)/a)*(u-a/2<0?-1:1);t(n,e,Math.max(r,Math.floor(e-u*l/a+h)),Math.min(i,Math.floor(e+(a-u)*l/a+h)),o)}const a=n[e];let u=r,s=i;for(p(n,r,e),o(n[i],a)>0&&p(n,r,i);u<s;){for(p(n,u,s),++u,--s;o(n[u],a)<0;)++u;for(;o(n[s],a)>0;)--s}0===o(n[r],a)?p(n,r,s):(++s,p(n,s,i)),s<=e&&(r=s+1),e<=s&&(i=s-1)}return n}(t,o).subarray(0,o+1));return u+(g(t.subarray(o+1))-u)*(i-o)}}var M={value:()=>{}};function y(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new m(r)}function m(t){this._=t}function b(t,n){return t.trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))}function k(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function N(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=M,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}function x(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function A(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function S(){}m.prototype=y.prototype={constructor:m,on:function(t,n){var e,r=this._,i=b(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++a<o;)if(e=(t=i[a]).type)r[e]=N(r[e],t.name,n);else if(null==n)for(e in r)r[e]=N(r[e],t.name,null);return this}for(;++a<o;)if((e=(t=i[a]).type)&&(e=k(r[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new m(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),a=0;a<e;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,e=(r=this._[t]).length;a<e;++a)r[a].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(n,e)}};var L=1/.7,D="\\s*([+-]?\\d+)\\s*",$="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",E="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",R=/^#([0-9a-f]{3,8})$/,j=new RegExp("^rgb\\("+[D,D,D]+"\\)$"),q=new RegExp("^rgb\\("+[E,E,E]+"\\)$"),C=new RegExp("^rgba\\("+[D,D,D,$]+"\\)$"),J=new RegExp("^rgba\\("+[E,E,E,$]+"\\)$"),O=new RegExp("^hsl\\("+[$,E,E]+"\\)$"),T=new RegExp("^hsla\\("+[$,E,E,$]+"\\)$"),z={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function H(){return this.rgb().formatHex()}function _(){return this.rgb().formatRgb()}function F(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=R.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?I(n):3===e?new V(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?P(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?P(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=j.exec(t))?new V(n[1],n[2],n[3],1):(n=q.exec(t))?new V(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=C.exec(t))?P(n[1],n[2],n[3],n[4]):(n=J.exec(t))?P(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=O.exec(t))?U(n[1],n[2]/100,n[3]/100,1):(n=T.exec(t))?U(n[1],n[2]/100,n[3]/100,n[4]):z.hasOwnProperty(t)?I(z[t]):"transparent"===t?new V(NaN,NaN,NaN,0):null}function I(t){return new V(t>>16&255,t>>8&255,255&t,1)}function P(t,n,e,r){return r<=0&&(t=n=e=NaN),new V(t,n,e,r)}function W(t){return t instanceof S||(t=F(t)),t?new V((t=t.rgb()).r,t.g,t.b,t.opacity):new V}function Q(t,n,e,r){return 1===arguments.length?W(t):new V(t,n,e,null==r?1:r)}function V(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function B(){return"#"+G(this.r)+G(this.g)+G(this.b)}function X(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function G(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function U(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new Z(t,n,e,r)}function Y(t){if(t instanceof Z)return new Z(t.h,t.s,t.l,t.opacity);if(t instanceof S||(t=F(t)),!t)return new Z;if(t instanceof Z)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),a=Math.max(n,e,r),o=NaN,u=a-i,s=(a+i)/2;return u?(o=n===a?(e-r)/u+6*(e<r):e===a?(r-n)/u+2:(n-e)/u+4,u/=s<.5?a+i:2-a-i,o*=60):u=s>0&&s<1?0:o,new Z(o,u,s,t.opacity)}function Z(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function K(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}x(S,F,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:H,formatHex:H,formatHsl:function(){return Y(this).formatHsl()},formatRgb:_,toString:_}),x(V,Q,A(S,{brighter:function(t){return t=null==t?L:Math.pow(L,t),new V(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new V(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:B,formatHex:B,formatRgb:X,toString:X})),x(Z,(function(t,n,e,r){return 1===arguments.length?Y(t):new Z(t,n,e,null==r?1:r)}),A(S,{brighter:function(t){return t=null==t?L:Math.pow(L,t),new Z(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Z(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new V(K(t>=240?t-240:t+120,i,r),K(t,i,r),K(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const tt=t=>()=>t;function nt(t,n){var e=n-t;return e?function(t,n){return function(e){return t+e*n}}(t,e):tt(isNaN(t)?n:t)}const et=function t(n){var e=function(t){return 1==(t=+t)?nt:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):tt(isNaN(n)?e:n)}}(n);function r(t,n){var r=e((t=Q(t)).r,(n=Q(n)).r),i=e(t.g,n.g),a=e(t.b,n.b),o=nt(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=a(n),t.opacity=o(n),t+""}}return r.gamma=t,r}(1);function rt(t,n){n||(n=[]);var e,r=t?Math.min(n.length,t.length):0,i=n.slice();return function(a){for(e=0;e<r;++e)i[e]=t[e]*(1-a)+n[e]*a;return i}}function it(t,n){var e,r=n?n.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(e=0;e<i;++e)a[e]=ct(t[e],n[e]);for(;e<r;++e)o[e]=n[e];return function(t){for(e=0;e<i;++e)o[e]=a[e](t);return o}}function at(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function ot(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function ut(t,n){var e,r={},i={};for(e in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)e in t?r[e]=ct(t[e],n[e]):i[e]=n[e];return function(t){for(e in r)i[e]=r[e](t);return i}}var st=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lt=new RegExp(st.source,"g");function ht(t,n){var e,r,i,a=st.lastIndex=lt.lastIndex=0,o=-1,u=[],s=[];for(t+="",n+="";(e=st.exec(t))&&(r=lt.exec(n));)(i=r.index)>a&&(i=n.slice(a,i),u[o]?u[o]+=i:u[++o]=i),(e=e[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:ot(e,r)})),a=lt.lastIndex;return a<n.length&&(i=n.slice(a),u[o]?u[o]+=i:u[++o]=i),u.length<2?s[0]?function(t){return function(n){return t(n)+""}}(s[0].x):function(t){return function(){return t}}(n):(n=s.length,function(t){for(var e,r=0;r<n;++r)u[(e=s[r]).i]=e.x(t);return u.join("")})}function ct(t,n){var e,r,i=typeof n;return null==n||"boolean"===i?tt(n):("number"===i?ot:"string"===i?(e=F(n))?(n=e,et):ht:n instanceof F?et:n instanceof Date?at:(r=n,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(n)?it:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?ut:ot:rt))(t,n)}function ft(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}y("start","end","cancel","interrupt");var dt=Array.prototype.slice;function vt(t,n){return t-n}const gt=t=>()=>t;function pt(t,n){for(var e,r=-1,i=n.length;++r<i;)if(e=wt(t,n[r]))return e;return 0}function wt(t,n){for(var e=n[0],r=n[1],i=-1,a=0,o=t.length,u=o-1;a<o;u=a++){var s=t[a],l=s[0],h=s[1],c=t[u],f=c[0],d=c[1];if(Mt(s,c,n))return 0;h>r!=d>r&&e<(f-l)*(r-h)/(d-h)+l&&(i=-i)}return i}function Mt(t,n,e){var r,i,a,o;return function(t,n,e){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])}(t,n,e)&&(i=t[r=+(t[0]===n[0])],o=n[r],i<=(a=e[r])&&a<=o||o<=a&&a<=i)}function yt(){}var mt=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function bt(){var t=1,n=1,e=d,r=u;function i(t){var n=e(t);if(Array.isArray(n))n=n.slice().sort(vt);else{var r=function(t){let n,e;for(const r of t)null!=r&&(void 0===n?r>=r&&(n=e=r):(n>r&&(n=r),e<r&&(e=r)));return[n,e]}(t),i=r[0],o=r[1];n=f(i,o,n),n=function(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=0|Math.max(0,Math.ceil((n-t)/e)),a=new Array(i);++r<i;)a[r]=t+r*e;return a}(Math.floor(i/n)*n,Math.floor(o/n)*n,n)}return n.map((function(n){return a(t,n)}))}function a(e,i){var a=[],u=[];return function(e,r,i){var a,u,s,l,h,c=new Array,f=new Array;for(a=u=-1,mt[(s=e[0]>=r)<<1].forEach(d);++a<t-1;)mt[s|(s=e[a+1]>=r)<<1].forEach(d);for(mt[s<<0].forEach(d);++u<n-1;){for(a=-1,mt[(s=e[u*t+t]>=r)<<1|(l=e[u*t]>=r)<<2].forEach(d);++a<t-1;)h=l,mt[s|(s=e[u*t+t+a+1]>=r)<<1|(l=e[u*t+a+1]>=r)<<2|h<<3].forEach(d);mt[s|l<<3].forEach(d)}for(a=-1,mt[(l=e[u*t]>=r)<<2].forEach(d);++a<t-1;)h=l,mt[(l=e[u*t+a+1]>=r)<<2|h<<3].forEach(d);function d(t){var n,e,r=[t[0][0]+a,t[0][1]+u],s=[t[1][0]+a,t[1][1]+u],l=o(r),h=o(s);(n=f[l])?(e=c[h])?(delete f[n.end],delete c[e.start],n===e?(n.ring.push(s),i(n.ring)):c[n.start]=f[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete f[n.end],n.ring.push(s),f[n.end=h]=n):(n=c[h])?(e=f[l])?(delete c[n.start],delete f[e.end],n===e?(n.ring.push(s),i(n.ring)):c[e.start]=f[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete c[n.start],n.ring.unshift(r),c[n.start=l]=n):c[l]=f[h]={start:l,end:h,ring:[r,s]}}mt[l<<3].forEach(d)}(e,i,(function(t){r(t,e,i),function(t){for(var n=0,e=t.length,r=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)r+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return r}(t)>0?a.push([t]):u.push(t)})),u.forEach((function(t){for(var n,e=0,r=a.length;e<r;++e)if(-1!==pt((n=a[e])[0],t))return void n.push(t)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(n){return 2*n[0]+n[1]*(t+1)*4}function u(e,r,i){e.forEach((function(e){var a,o=e[0],u=e[1],s=0|o,l=0|u,h=r[l*t+s];o>0&&o<t&&s===o&&(e[0]=o+(i-(a=r[l*t+s-1]))/(h-a)-.5),u>0&&u<n&&l===u&&(e[1]=u+(i-(a=r[(l-1)*t+s]))/(h-a)-.5)}))}return i.contour=a,i.size=function(e){if(!arguments.length)return[t,n];var r=Math.floor(e[0]),a=Math.floor(e[1]);if(!(r>=0&&a>=0))throw new Error("invalid size");return t=r,n=a,i},i.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?gt(dt.call(t)):gt(t),i):e},i.smooth=function(t){return arguments.length?(r=t?u:yt,i):r===u},i}function kt(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function Nt(t){return(t=kt(Math.abs(t)))?t[1]:NaN}var xt,At=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function St(t){if(!(n=At.exec(t)))throw new Error("invalid format: "+t);var n;return new Lt({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function Lt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Dt(t,n){var e=kt(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}St.prototype=Lt.prototype,Lt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const $t={"%":(t,n)=>(100*t).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>Dt(100*t,n),r:Dt,s:function(t,n){var e=kt(t,n);if(!e)return t+"";var r=e[0],i=e[1],a=i-(xt=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+kt(t,Math.max(0,n+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Et(t){return t}var Rt,jt,qt,Ct=Array.prototype.map,Jt=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Ot(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}function Tt(t){return+t}Rt=function(t){var n,e,r=void 0===t.grouping||void 0===t.thousands?Et:(n=Ct.call(t.grouping,Number),e=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,u=n[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),a.push(t.substring(i-=u,i+u)),!((s+=u+1)>r));)u=n[o=(o+1)%n.length];return a.reverse().join(e)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?Et:function(t){return function(n){return n.replace(/[0-9]/g,(function(n){return t[+n]}))}}(Ct.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"−":t.minus+"",h=void 0===t.nan?"NaN":t.nan+"";function c(t){var n=(t=St(t)).fill,e=t.align,c=t.sign,f=t.symbol,d=t.zero,v=t.width,g=t.comma,p=t.precision,w=t.trim,M=t.type;"n"===M?(g=!0,M="g"):$t[M]||(void 0===p&&(p=12),w=!0,M="g"),(d||"0"===n&&"="===e)&&(d=!0,n="0",e="=");var y="$"===f?i:"#"===f&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",m="$"===f?a:/[%p]/.test(M)?s:"",b=$t[M],k=/[defgprs%]/.test(M);function N(t){var i,a,s,f=y,N=m;if("c"===M)N=b(t)+N,t="";else{var x=(t=+t)<0||1/t<0;if(t=isNaN(t)?h:b(Math.abs(t),p),w&&(t=function(t){t:for(var n,e=t.length,r=1,i=-1;r<e;++r)switch(t[r]){case".":i=n=r;break;case"0":0===i&&(i=r),n=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(n+1):t}(t)),x&&0==+t&&"+"!==c&&(x=!1),f=(x?"("===c?c:l:"-"===c||"("===c?"":c)+f,N=("s"===M?Jt[8+xt/3]:"")+N+(x&&"("===c?")":""),k)for(i=-1,a=t.length;++i<a;)if(48>(s=t.charCodeAt(i))||s>57){N=(46===s?o+t.slice(i+1):t.slice(i))+N,t=t.slice(0,i);break}}g&&!d&&(t=r(t,1/0));var A=f.length+t.length+N.length,S=A<v?new Array(v-A+1).join(n):"";switch(g&&d&&(t=r(S+t,S.length?v-N.length:1/0),S=""),e){case"<":t=f+t+N+S;break;case"=":t=f+S+t+N;break;case"^":t=S.slice(0,A=S.length>>1)+f+t+N+S.slice(A);break;default:t=S+f+t+N}return u(t)}return p=void 0===p?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),N.toString=function(){return t+""},N}return{format:c,formatPrefix:function(t,n){var e=c(((t=St(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Nt(n)/3))),i=Math.pow(10,-r),a=Jt[8+r/3];return function(t){return e(i*t)+a}}}}({thousands:",",grouping:[3],currency:["$",""]}),jt=Rt.format,qt=Rt.formatPrefix;var zt=[0,1];function Ht(t){return t}function _t(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:(e=isNaN(n)?NaN:.5,function(){return e});var e}function Ft(t,n,e){var r=t[0],i=t[1],a=n[0],o=n[1];return i<r?(r=_t(i,r),a=e(o,a)):(r=_t(r,i),a=e(a,o)),function(t){return a(r(t))}}function It(t,n,e){var r=Math.min(t.length,n.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++o<r;)i[o]=_t(t[o],t[o+1]),a[o]=e(n[o],n[o+1]);return function(n){var e=u(t,n,1,r)-1;return a[e](i[e](n))}}function Pt(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Wt(){return function(){var t,n,e,r,i,a,o=zt,u=zt,s=ct,l=Ht;function h(){var t,n,e,s=Math.min(o.length,u.length);return l!==Ht&&((t=o[0])>(n=o[s-1])&&(e=t,t=n,n=e),l=function(e){return Math.max(t,Math.min(n,e))}),r=s>2?It:Ft,i=a=null,c}function c(n){return isNaN(n=+n)?e:(i||(i=r(o.map(t),u,s)))(t(l(n)))}return c.invert=function(e){return l(n((a||(a=r(u,o.map(t),ot)))(e)))},c.domain=function(t){return arguments.length?(o=Array.from(t,Tt),h()):o.slice()},c.range=function(t){return arguments.length?(u=Array.from(t),h()):u.slice()},c.rangeRound=function(t){return u=Array.from(t),s=ft,h()},c.clamp=function(t){return arguments.length?(l=!!t||Ht,h()):l!==Ht},c.interpolate=function(t){return arguments.length?(s=t,h()):s},c.unknown=function(t){return arguments.length?(e=t,c):e},function(e,r){return t=e,n=r,h()}}()(Ht,Ht)}function Qt(t){var n=t.domain;return t.ticks=function(t){var e=n();return function(t,n,e){var r,i,a,o,u=-1;if(e=+e,(t=+t)==(n=+n)&&e>0)return[t];if((r=n<t)&&(i=t,t=n,n=i),0===(o=c(t,n,e))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),n=Math.floor(n/o),a=new Array(i=Math.ceil(n-t+1));++u<i;)a[u]=(t+u)*o;else for(o=-o,t=Math.ceil(t*o),n=Math.floor(n*o),a=new Array(i=Math.ceil(n-t+1));++u<i;)a[u]=(t+u)/o;return r&&a.reverse(),a}(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){var r=n();return function(t,n,e,r){var i,a=f(t,n,e);switch((r=St(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(n));return null!=r.precision||isNaN(i=function(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Nt(n)/3)))-Nt(Math.abs(t)))}(a,o))||(r.precision=i),qt(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,Nt(n)-Nt(t))+1}(a,Math.max(Math.abs(t),Math.abs(n))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-Nt(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return jt(r)}(r[0],r[r.length-1],null==t?10:t,e)},t.nice=function(e){null==e&&(e=10);var r,i,a=n(),o=0,u=a.length-1,s=a[o],l=a[u],h=10;for(l<s&&(i=s,s=l,l=i,i=o,o=u,u=i);h-- >0;){if((i=c(s,l,e))===r)return a[o]=s,a[u]=l,n(a);if(i>0)s=Math.floor(s/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;s=Math.ceil(s*i)/i,l=Math.floor(l*i)/i}r=i}return t},t}function Vt(){var t=Wt();return t.copy=function(){return Pt(t,Vt())},Ot.apply(t,arguments),Qt(t)}const Bt=class{constructor(n){t(this,n),this.variableOptions=["Elevation","MaxTemperature","MinTemperature","Precipitation","Wind","RelativeHumidity","Solar"],this.colorScheme=["#2c7bb6","#abd9e9","#fdae61","#f32a2c"],this.timeBy="Month",this.textureDefinitions=["this.textures.circles().radius(2)","this.textures.circles().radius(3)","this.textures.circles().radius(4)","this.textures.circles().radius(5)"]}async connectedCallback(){this.SQL=await i({locateFile:t=>"./assets/sql.js/"+t})}render(){var t;return n(e,null,n("ion-header",null,n("ion-toolbar",{color:"primary"},n("ion-title",null,"Weather Vis"," - "+((null===(t=this.file)||void 0===t?void 0:t.name)||"No File Opened")),n("ion-buttons",{slot:"start"},n("ion-back-button",{defaultHref:"/"})),n("ion-buttons",{slot:"end"},n("ion-button",{title:"Open",onClick:()=>this.fileInputElement.click()},n("ion-icon",{slot:"icon-only",name:"open"}))))),n("ion-content",{class:"ion-padding"},n("ion-item",{disabled:!this.file},n("ion-label",null,"Variables"),n("ion-select",{multiple:!0,onIonChange:async({detail:t})=>{this.selectedVariables=t.value,this.updateData(1),this.updateData(2)}},this.variableOptions.map(t=>n("ion-select-option",null,t)))),n("ion-item",{disabled:!this.file},n("ion-label",null,"Time By"),n("ion-select",{value:this.timeBy,onIonChange:async({detail:t})=>{this.timeBy=t.value,this.updateData(1),this.updateData(2)}},n("ion-select-option",null,"Day"),n("ion-select-option",null,"Week"),n("ion-select-option",null,"Month"),n("ion-select-option",null,"Quarter "))),n("div",null,n("s-set-vis",{ref:t=>this.setVisElement=t,"parallel-sets-ribbon-tension":.5,parallelSetsDimensions:[""],parallelSetsMaxSegmentLimit:12,parallelSetsTexutureDefinitions:this.textureDefinitions,parallelSetsColorScheme:this.colorScheme,"dark-mode":JSON.parse(localStorage.getItem("isDarkModeEnabled"))}),n("iframe",{width:"600",height:"600",style:{border:"0"},ref:async t=>{this.mapIframeElement=t;const n=await(await fetch("./assets/map.html")).text();t.contentDocument.querySelector("div#map")||(t.contentDocument.open(),t.contentDocument.write(n),t.contentDocument.close(),window.addEventListener("message",n=>{if(n.source===this.mapIframeElement.contentWindow){const e=n.data;switch(e.type){case"hello":t.contentWindow.postMessage({type:"view center point",info:[0,0]},"*");break;case"select rect":this.updateData(1,e.info)}}}))}}),n("ion-button",{onClick:()=>this.mapIframeElement.contentWindow.postMessage({type:"reset range selection"},"*")},"Remove Range Selection")),n("div",null,n("s-set-vis",{ref:t=>this.setVisElement2=t,"parallel-sets-ribbon-tension":.5,parallelSetsDimensions:[""],parallelSetsMaxSegmentLimit:12,parallelSetsTexutureDefinitions:this.textureDefinitions,parallelSetsColorScheme:this.colorScheme,"dark-mode":JSON.parse(localStorage.getItem("isDarkModeEnabled"))}),n("iframe",{width:"600",height:"600",style:{border:"0"},ref:async t=>{this.mapIframeElement2=t;const n=await(await fetch("./assets/map.html")).text();t.contentDocument.querySelector("div#map")||(t.contentDocument.open(),t.contentDocument.write(n),t.contentDocument.close(),window.addEventListener("message",n=>{if(n.source===this.mapIframeElement2.contentWindow){const e=n.data;switch(e.type){case"hello":t.contentWindow.postMessage({type:"view center point",info:[0,0]},"*");break;case"select rect":this.updateData(2,e.info)}}}))}}),n("ion-button",{onClick:()=>this.mapIframeElement2.contentWindow.postMessage({type:"reset range selection"},"*")},"Remove Range Selection"))),n("input",{id:"file-input",type:"file",ref:t=>this.fileInputElement=t,onInput:async({target:t})=>{var n;this.file=null===(n=t.files)||void 0===n?void 0:n[0];const e=await r.create({message:`Opening ${this.file.name}...`});await e.present();const i=await this.file.arrayBuffer();this.DB=new this.SQL.Database(new Uint8Array(i)),await e.dismiss()}}))}async updateData(t,n){const e=await this.queryData(this.selectedVariables,this.timeBy,n);if(1===t){const t=new Set(e.map(t=>t.Longitude)),n=new Set(e.map(t=>t.Latitude)),r=t.size,i=n.size,a=Math.min(...t),o=Math.max(...t),u=Math.min(...n),s=Math.max(...n),l=bt().size([r,i]).thresholds([.25,.5,.75,1]).smooth(!0)(e.filter(t=>"Jan"===t.Date).map(t=>t["_"+this.selectedVariables[0]])),h=Vt().domain([0,r]).range([a,o]),c=Vt().domain([0,i]).range([u,s]),f=l.map(t=>(t.coordinates=t.coordinates.map(t=>t.map(t=>t.map(([t,n])=>[h(t),c(n)]))),t));this.mapIframeElement.contentWindow.postMessage({type:"contour",info:{geoJson:f,colorDict:{.25:this.colorScheme[0],.5:this.colorScheme[1],.75:this.colorScheme[2],1:this.colorScheme[3]}}},"*"),this.mapIframeElement.contentWindow.postMessage({type:"view center point",info:{location:[(this.datasetInfo.maxLatitude+this.datasetInfo.minLatitude)/2,(this.datasetInfo.maxLongitude+this.datasetInfo.minLongitude)/2],zoom:6}},"*"),this.setVisElement.data=e,this.setVisElement.parallelSetsDimensions=this.selectedVariables.map(t=>"_"+t).concat(["Date"]),this.setVisElement.statisticsPlotGroupDefinitions=this.selectedVariables.map(t=>({dimensionName:t,visType:"box"}))}else if(2===t){const t=new Set(e.map(t=>t.Longitude)),n=new Set(e.map(t=>t.Latitude)),r=t.size,i=n.size,a=Math.min(...t),o=Math.max(...t),u=Math.min(...n),s=Math.max(...n),l=bt().size([r,i]).thresholds([.25,.5,.75,1]).smooth(!0)(e.filter(t=>"Jan"===t.Date).map(t=>t["_"+this.selectedVariables[0]])),h=Vt().domain([0,r]).range([a,o]),c=Vt().domain([0,i]).range([u,s]),f=l.map(t=>(t.coordinates=t.coordinates.map(t=>t.map(t=>t.map(([t,n])=>[h(t),c(n)]))),t));this.mapIframeElement2.contentWindow.postMessage({type:"contour",info:{geoJson:f,colorDict:{.25:this.colorScheme[0],.5:this.colorScheme[1],.75:this.colorScheme[2],1:this.colorScheme[3]}}},"*"),this.mapIframeElement2.contentWindow.postMessage({type:"view center point",info:{location:[(this.datasetInfo.maxLatitude+this.datasetInfo.minLatitude)/2,(this.datasetInfo.maxLongitude+this.datasetInfo.minLongitude)/2],zoom:6}},"*"),this.setVisElement2.data=e,this.setVisElement2.parallelSetsDimensions=this.selectedVariables.map(t=>"_"+t).concat(["Date"]),this.setVisElement2.statisticsPlotGroupDefinitions=this.selectedVariables.map(t=>({dimensionName:t,visType:"box"}))}}async queryData(t,n,e){var i,o;let s=[];if((null==t?void 0:t.length)>0&&n){const l=await r.create({message:"Qeurying data..."});let h,c;switch(await l.present(),n){case"Day":h="select Date, Latitude, Longitude, "+t.join(", ")+" from weather",e&&(h+=` where Latitude >= ${e.minLat} and Latitude <= ${e.maxLat} and Longitude >= ${e.minLon} and Longitude <= ${e.maxLon}`);break;case"Week":case"Month":case"Quarter":h="select substr(Date, 0, 8) as Date, Latitude, Longitude, "+t.map(t=>`avg(${t}) as ${t}`).join(", ")+" from weather",e&&(h+=` where Latitude >= ${e.minLat} and Latitude <= ${e.maxLat} and Longitude >= ${e.minLon} and Longitude <= ${e.maxLon}`),h+=" group by substr(Date, 0, 8), Latitude, Longitude"}if(c=null===(i=this.DB.exec(h))||void 0===i?void 0:i[0],s=null==c?void 0:c.values.map(t=>{const n={};for(let e=0;e<t.length;e++)n[c.columns[e]]="Date"===c.columns[e]?this.obtainDateString(t[e]):+t[e];return n}),s){const n={};t.forEach(t=>n[t]=function t(){var n,e=[],r=[],i=[];function o(){var t=0,n=Math.max(1,r.length);for(i=new Array(n-1);++t<n;)i[t-1]=w(e,t/n);return s}function s(t){return isNaN(t=+t)?n:r[u(i,t)]}return s.invertExtent=function(t){var n=r.indexOf(t);return n<0?[NaN,NaN]:[n>0?i[n-1]:e[0],n<i.length?i[n]:e[e.length-1]]},s.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(a),o()},s.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},s.unknown=function(t){return arguments.length?(n=t,s):n},s.quantiles=function(){return i.slice()},s.copy=function(){return t().domain(e).range(r).unknown(n)},Ot.apply(s,arguments)}().domain(s.map(n=>n[t])).range([.25,.5,.75,1])),s.forEach(e=>t.forEach(t=>e["_"+t]=n[t](e[t])))}e||(h="select min(Latitude) as minLatitude, max(Latitude) as maxLatitude, count(distinct Latitude) as latitudeCount, min(Longitude) as minLongitude, max(Longitude) as maxLongitude, count(distinct Longitude) as longitudeCount from weather",c=null===(o=this.DB.exec(h))||void 0===o?void 0:o[0],this.datasetInfo=c.values.map(t=>{const n={};for(let e=0;e<t.length;e++)n[c.columns[e]]=+t[e];return n})[0]),await l.dismiss()}return s}obtainDateString(t){switch(t.substring(5)){case"01":return"Jan";case"02":return"Feb";case"03":return"Mar";case"04":return"Apr";case"05":return"May";case"06":return"Jun";case"07":return"Jul";case"08":return"Aug";case"09":return"Sep";case"10":return"Oct";case"11":return"Nov";case"12":return"Dec"}}};Bt.style=".sc-app-weather-vis-h{display:block}#file-input.sc-app-weather-vis{display:none}s-set-vis.sc-app-weather-vis{height:600px;width:calc(100% - 650px);display:inline-flex}iframe.sc-app-weather-vis{display:inline-block}";export{Bt as app_weather_vis}